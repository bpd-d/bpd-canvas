!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("bpdCanvas",[],e):"object"==typeof exports?exports.bpdCanvas=e():t.bpdCanvas=e()}(this,(function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";function i(t){return!1!==t}function n(t,e){return Object.assign(Object.assign({},t),e)}function r(t,...e){return 1===e.length?Object.assign(Object.assign({},t),e[0]):e.reduce((t,e)=>e?Object.assign(Object.assign({},t),e):t,Object.assign({},t))}function*o(){let t=1;for(;;){((yield t++)||t>2e5)&&(t=1)}}function a(t,e,s){return Math.round(Math.max(Math.min(s,t),0))}function h(t){return(t=Math.max(t,0))>1?Math.min(t,100)/100:t}function u(t,e,s){"number"!=typeof s||s<0||s>=t.length?t.push(...e):t.splice(s,0,...e)}s.r(e),s.d(e,"StringColorBase",(function(){return f})),s.d(e,"Color",(function(){return b})),s.d(e,"RgbColor",(function(){return x})),s.d(e,"HslColor",(function(){return y})),s.d(e,"CanvasLinearGradientColor",(function(){return S})),s.d(e,"CanvasSourcePattern",(function(){return v})),s.d(e,"CanvasAssistant",(function(){return G})),s.d(e,"LineData",(function(){return X})),s.d(e,"Line",(function(){return Y})),s.d(e,"CurveData",(function(){return Q})),s.d(e,"Curve",(function(){return q})),s.d(e,"ArcData",(function(){return H})),s.d(e,"Arc",(function(){return J})),s.d(e,"BezierCurveData",(function(){return N})),s.d(e,"BezierCurve",(function(){return V})),s.d(e,"QuadraticCurveData",(function(){return U})),s.d(e,"QuadraticCurve",(function(){return Z})),s.d(e,"EllipseData",(function(){return tt})),s.d(e,"Ellipse",(function(){return et})),s.d(e,"ObjectProperties",(function(){return st})),s.d(e,"Font",(function(){return it})),s.d(e,"CanvasImage",(function(){return T})),s.d(e,"Rectangle",(function(){return M})),s.d(e,"CanvasPath",(function(){return F})),s.d(e,"CanvasText",(function(){return R}));class c extends Error{constructor(t,e){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name=t}}class l extends c{constructor(t){super("InitializationError",t)}}class d extends c{constructor(t,e){super("IteratorException",`[${t}] ${null!=e?e:""}`)}}class p extends c{constructor(t,e,s){super("ElementException",`[${t}][${e}] ${null!=s?s:""}`)}}class _ extends c{constructor(t,e){super("SetterException",`[${t}] ${null!=e?e:""}`)}}class g extends c{constructor(t,e){super("MapperExecption",`Error occured on [${t}]: ${e}`)}}class f{constructor(t,e){this._converter=t,this._color=e}set(t){this._color=Object.assign(Object.assign({},this._color),t)}get(){return this._color}asString(){return this._converter(this._color)}toStyle(){return this.asString()}}class b extends f{constructor(t){super(t=>t,t)}set(t){this._color=t}}class x extends f{constructor(t){super(t=>`rgba(${a(j(t.red,0),0,255)},${a(j(t.green,0),0,255)},${a(j(t.blue,0),0,255)},${h(j(t.alpha,1))})`,t)}setRed(t){this._color.red=t}setGreen(t){this._color.green=t}setBlue(t){this._color.blue=t}setAlpha(t){this._color.alpha=t}fromHex(t){const e=function(t){const e=t.startsWith("#")?t.substring(1):t,s=e.length,i=w.get(s);return i?i(e):null}(t);e&&this.set(e)}}class y extends f{constructor(t){super(t=>`hsla(${a(j(t.hue,0),0,360)},${a(j(t.saturation,0),0,100)}%,${a(j(t.lightness,0),0,100)}%,${h(j(t.alpha,1))})`,t)}setHue(t){this._color.hue=t}setSaturation(t){this._color.saturation=t}setLightness(t){this._color.lightness=t}setAlpha(t){this._color.alpha=t}}class S{constructor(t,e){this._context=t,this._colors=new Map,this._size={height:0,width:0},this._startingPoint={x:0,y:0},e&&(this.setPosition(e),this.setSize(e))}addColor(t,e){this._colors.set(t,e)}removeColor(t){return this._colors.delete(t)}clearColors(){this._colors.clear()}setPosition(t){const{x:e,y:s}=t;this._startingPoint={x:e,y:s}}setSize(t){const{width:e,height:s}=t;this._size={width:e,height:s}}toStyle(){const t=this._context.createLinearGradient(this._startingPoint.x,this._startingPoint.y,this._size.width,this._size.height);return this._colors.forEach((e,s)=>{const i=h(s);t.addColorStop(i,e.asString())}),t}}class v{constructor(t,e){this._context=t,this._definition=null!=e?e:{}}set(t){return n(this._definition,t),this}toStyle(){var t;if(!this._definition||!this._definition.source)throw new c("CanvasImagePatternError","Cannot create pattern, source is missing");const e=this._context.createPattern(this._definition.source,null!==(t=this._definition.repeat)&&void 0!==t?t:"");if(!e)throw new c("CanvasImagePatternError","Pattern was not created");return e}}function j(t,e){return null!=t?t:e}function m(t){return parseInt(t,16)}const w=new Map([[1,function(t){const e=m(t+t);return{red:e,green:e,blue:e,alpha:1}}],[3,function(t){return{red:m(t[0]),green:m(t[1]),blue:m(t[2]),alpha:1}}],[6,C],[8,function(t){return Object.assign(Object.assign({},C(t)),{alpha:m(t.substr(6,2))})}]]);function C(t){return{red:m(t.substr(0,2)),green:m(t.substr(2,2)),blue:m(t.substr(4,2)),alpha:1}}function k(t,e,s){"function"!=typeof t[e]&&"function"!=typeof s&&(t[e]=s)}function P(){return{set:(t,e,s)=>{k(t,e,s.toStyle())}}}function O(t,e){const s="float"===t?parseFloat:parseInt;return{set:(i,n,r)=>{const o=s(r);if(isNaN(o)){if(!e)throw new _(t,"Value is not a number");k(i,n,e)}else k(i,n,o)}}}function A(t,e){return{set:(s,i,n)=>{t.includes(n)?k(s,i,n):e&&k(s,i,e)}}}class z{constructor(t){this._map=t}map(t,e,s){const i=null!=s?s:[];this._map.forEach(s=>{var n;const r=s.key.toString();if(i.includes(r))return;const o=function(t,...e){const s=e.length;if(0===s)return;for(let i=0;i<s;i++){const s=e[i][t];if(I(s))return s}return}(s.key,...e);if(o){const e=null!==(n=s.mapTo)&&void 0!==n?n:s.key;if(s.setter)return void s.setter.set(t,e,o);try{k(t,e,o)}catch(t){throw new g(e+"",t.message)}}})}}function I(t){return null!=t}const D=2*Math.PI,$=new Map([["line",o()],["rect",o()],["path",o()],["curve",o()],["text",o()],["ellipse",o()],["image",o()]]);function E(t,e){const s=$.get(t);if(!s)throw new d(t,"Iterator for counter has not been found");const i=s.next();if(i.done)throw new d(t,"Iterator is done");return`${null!=e?e:t}_${i.value}`}class B extends class{constructor(t){this._context=t}}{constructor(t,e,s){var i;super(t.context),this._global=t.settings,this._settings=Object.assign({},this._global),this._useGlobalSettings=t.useGlobal,this._mapper=t.mapper,this._objectSetup=e,this.id=null!==(i=t.key)&&void 0!==i?i:E(s)}set(t){return this._objectSetup?(n(this._objectSetup,t),this):(this._objectSetup=Object.assign({},t),this)}fill(t){return this._settings.isFill=i(t),this}stroke(t){return this._settings.isStroke=i(t),this}setSettings(t){return this._settings=n(this._settings,t),this}getKey(){return this.id}drawOptions(){this._settings.isFill&&this._context.fill(),this._settings.isStroke&&this._context.stroke()}setStyles(t){const e=[this._settings];this._useGlobalSettings&&e.push(this._global),this._mapper.map(this._context,e,t)}}class T extends B{constructor(t,e){super(t,null!=e?e:{},"image"),this._objectSetup||(this._objectSetup={})}draw(){this._objectSetup.source&&(this.setStyles(),this._objectSetup.position?this._context.drawImage(this._objectSetup.source,this._objectSetup.position.x,this._objectSetup.position.y):this._objectSetup.imageSlice&&this._objectSetup.desitnationCoords&&this._context.drawImage(this._objectSetup.source,this._objectSetup.imageSlice.x,this._objectSetup.imageSlice.y,this._objectSetup.imageSlice.width,this._objectSetup.imageSlice.height,this._objectSetup.desitnationCoords.x,this._objectSetup.desitnationCoords.y,this._objectSetup.desitnationCoords.width,this._objectSetup.desitnationCoords.height))}getRect(){var t,e,s,i;return{x:0,y:0,width:null!==(e=null===(t=this._objectSetup.source)||void 0===t?void 0:t.width)&&void 0!==e?e:0,height:null!==(i=null===(s=this._objectSetup.source)||void 0===s?void 0:s.height)&&void 0!==i?i:0}}}class F extends B{constructor(t,e){super(t,null!=e?e:{x:-1,y:-1},"path"),this._settings.isStroke=!0,this._isClosePath=!1,this._moveBeforeBuild=!0,this._paths=[]}from(t){return this._objectSetup=Object.assign({},t),this}add(...t){return u(this._paths,t),this}doNotMoveBeforeBuild(){return this._moveBeforeBuild=!1,this}get(t){return t>-1&&t<this._paths.length?this._paths[t]:null}delete(t){t&&this._paths.splice(t,1)}insertAt(t,...e){return u(this._paths,e,t),this}setAt(t,e){return t>=0&&t<this._paths.length&&(this._paths[t]=e),this}close(t){this._isClosePath=i(t)}draw(){if(!this._objectSetup)return;this._context.beginPath(),this.setStyles();let t=this._objectSetup;try{this._moveBeforeBuild&&this._context.moveTo(t.x,t.y),this._paths.forEach(e=>{t=e.build(this._context,t)})}catch(t){throw new p("CanvasPath",this.id,t.message)}this._isClosePath&&this._context.closePath(),this.drawOptions()}getRect(){return{x:-1,y:-1,width:0,height:0}}}class M extends B{constructor(t,e){super(t,null!=e?e:{x:-1,y:-1,width:-1,height:-1},"rect"),this._settings.isFill=!0,this._objectSetup||(this._objectSetup={x:0,y:0,height:0,width:0})}setPosition(t){r(this._objectSetup,t)}setSize(t){r(this._objectSetup,t)}draw(){this.setStyles(),this._settings.isFill&&this._context.fillRect(this._objectSetup.x,this._objectSetup.y,this._objectSetup.width,this._objectSetup.height),this._settings.isStroke&&this._context.strokeRect(this._objectSetup.x,this._objectSetup.y,this._objectSetup.width,this._objectSetup.height)}getRect(){return Object.assign({},this._objectSetup)}}class R extends B{constructor(t,e){super(t,null!=e?e:{},"text"),this._settings.isFill=!0,this._objectSetup||(this._objectSetup={})}setFont(t){return this._settings.font=t,this}isValid(){return!!this._objectSetup&&(!(!this._objectSetup.text||0===this._objectSetup.text.length)&&!!this._objectSetup.position)}draw(){this.isValid()&&(this.setStyles(),this._settings.isFill&&this._context.fillText(this._objectSetup.text,this._objectSetup.position.x,this._objectSetup.position.y),this._settings.isStroke&&this._context.strokeText(this._objectSetup.text,this._objectSetup.position.x,this._objectSetup.position.y))}getRect(){return{x:0,y:0,width:0,height:0}}}class G{constructor(t){var e;this._canvas=t.canvas;const s=this._canvas.getContext("2d",{alpha:t.alpha,desynchronized:t.desynchronized});if(!s)throw new l("Context was not initialized");this._settings=null!==(e=t.settings)&&void 0!==e?e:{},this._useGlobalSettingsInComponents=i(t.useGlobalSettings),this._mapper=new z([{key:"strokeStyle",setter:P()},{key:"fillStyle",setter:P()},{key:"strokeWidth",mapTo:"lineWidth",setter:O("float")},{key:"font",setter:{set:(t,e,s)=>{k(t,e,"string"!=typeof s?s.asString():s)}}},{key:"mitterLimit",setter:O("integer")},{key:"lineCap",setter:A(["butt","round","square"],"square")},{key:"lineJoin",setter:A(["bevel","round","miter"],"miter")},{key:"lineDashOffset",setter:O("integer")},{key:"lineDash",setter:{set(t,e,s){Array.isArray(s)&&t.setLineDash(s)}}},{key:"textAlign",setter:A(["left","right","center","start","end"],"right")},{key:"textBaseline",setter:A(["top","hanging","middle","bottom","alphabetic","ideographic"],"alphabetic")},{key:"shadowColor",setter:P()},{key:"shadowOffsetX",setter:O("float")},{key:"shadowOffsetY",setter:O("float")},{key:"shadowBlur",setter:O("float")}]),this._context=s,t.size&&this.setCanvasSize(t.size)}getSetupForComponent(){return t=this._context,e=this._settings,s=this._mapper,i=this._useGlobalSettingsInComponents,{context:t,settings:e,mapper:s,useGlobal:i,key:n};var t,e,s,i,n}createPath(t){return new F(this.getSetupForComponent(),t)}createRectangle(t){return new M(this.getSetupForComponent(),t)}createText(t){return new R(this.getSetupForComponent(),t)}createImage(t){return new T(this.getSetupForComponent(),t)}setGlobalObjectProperties(t){this._settings=n(this._settings,t)}getGlobalObjectProperties(){return this._settings}setGlobalAlpha(t){this._context.globalAlpha=h(t)}setImageSmoothing(t,e){this._context.imageSmoothingEnabled=t,e&&t&&(this._context.imageSmoothingQuality=e)}getImageData(t){return this._context.getImageData(t.x,t.y,t.width,t.height)}putImageData(t,e,s){s?this._context.putImageData(t,e.x,e.y,s.x,s.y,s.width,s.height):this._context.putImageData(t,e.x,e.y)}createImageData(t,e){"number"!=typeof t?this._context.createImageData(t):this._context.createImageData(t,null!=e?e:0)}save(){this._context.save()}restore(){this._context.restore()}setCanvasSize(t){this._canvas.width=t.width,this._canvas.height=t.height}getCanvasSize(){return{width:this._canvas.width,height:this._canvas.height}}getContext(){return this._context}createLinearGradient(t){return new S(this._context,t)}createPattern(t){return new v(this._context,t)}clear(t){let e=null!=t?t:{x:0,y:0,width:(s=this._canvas).width,height:s.height};var s;this._context.clearRect(e.x,e.y,e.width,e.height)}}function L(t){return t?"string"==typeof t?{key:t,init:void 0}:t.init?{init:t.init,key:t.key}:{key:void 0,init:t}:{key:void 0,init:void 0}}class K{constructor(t,e,s,i){this.id=null!=i?i:E(e),this.name=t,this.data=s}getKey(){return this.id}set(t){return this.data=n(this.data,t),this}throw(t){throw new p(this.name,this.id,t)}validateKeys(t){return function(t,e,s){if(!t)return!1;const i=e.length;if(0===i)return!0;let n=e[0];for(let r=0;r<i;r++,n=e[r]){const e=t[n];if(!s(n.toString(),typeof t[n],e))return!1}return!0}(this.data,t,(t,e,s)=>("undefined"===e&&this.throw(`[${t}] not defined`),"number"===e&&s<0&&this.throw(`[${t}] is not correct`),!0))}}class W{constructor(t){this._data=t}get(){return this._data}}class X extends W{constructor(...t){super([...t])}to(...t){return this._data.push(...t),this}}class Y extends K{constructor(t){const{init:e,key:s}=L(t);super("Line","line",null!=e?e:[],s)}set(t){return this.data=[...t],this}build(t,e){0===this.data.length&&this.throw("There are no lines to draw");let s=this.data[0];return this.data.forEach(e=>{t.lineTo(e.x,e.y),s=e}),Object.assign({},s)}}class Q extends W{constructor(t){super(null!=t?t:{})}to(t){return this._data.end=t,this}corner(t){return this._data.corner=t,this}withRadius(t){return this._data.radius=t,this}}class q extends K{constructor(t){const{init:e,key:s}=L(t);super("Curve","curve",null!=e?e:{},s)}build(t,e){return this.validateKeys(["corner","end","radius"])&&(t.arcTo(this.data.corner.x,this.data.corner.y,this.data.end.x,this.data.end.y,this.data.radius),t.lineTo(this.data.end.x,this.data.end.y)),Object.assign({},this.data.end)}}class H extends W{constructor(t){super(null!=t?t:{startAngle:-1,endAngle:-1,radius:-1})}setStartAngle(t){return this._data.startAngle=t,this}setEndAngle(t){return this._data.endAngle=t,this}setRadius(t){return this._data.radius=t,this}}class J extends K{constructor(t){const{init:e,key:s}=L(t);super("Arc","curve",null!=e?e:{startAngle:-1,endAngle:-1,radius:-1},s)}build(t,e){return this.validateKeys(["endAngle","startAngle","radius"])&&t.arc(e.x,e.y,this.data.radius,this.data.startAngle,this.data.endAngle),Object.assign({},e)}}class N extends W{constructor(t){super(null!=t?t:{})}to(t){return this._data.end=t,this}by(t,e){return this._data.controlPoint=t,this._data.controlPoint2=e,this}}class V extends K{constructor(t){const{init:e,key:s}=L(t);super("BezierCurve","curve",null!=e?e:{},s)}build(t,e){return this.validateKeys(["controlPoint2","controlPoint","end"])&&t.bezierCurveTo(this.data.controlPoint.x,this.data.controlPoint.y,this.data.controlPoint2.x,this.data.controlPoint2.y,this.data.end.x,this.data.end.y),Object.assign({},this.data.end)}}class U extends W{constructor(t){super(null!=t?t:{})}to(t){return this._data.end=t,this}by(t){return this._data.controlPoint=t,this}}class Z extends K{constructor(t){const{init:e,key:s}=L(t);super("QuadraticCurve","curve",null!=e?e:{},s)}build(t,e){return this.validateKeys(["controlPoint","end"])&&t.quadraticCurveTo(this.data.controlPoint.x,this.data.controlPoint.y,this.data.end.x,this.data.end.y),Object.assign({},this.data.end)}}class tt extends W{constructor(t){super(null!=t?t:{rotation:0,startAngle:0,endAngle:D})}setRadius(t,e){return this._data.radiusX=t,this._data.radiusY=null!=e?e:t,this}setAngles(t,e){return this._data.startAngle=t,this._data.endAngle=e,this}setRotation(t){return this._data.rotation=t,this}}class et extends K{constructor(t){const{init:e,key:s}=L(t);super("Ellipse","ellipse",null!=e?e:{},s)}build(t,e){return this.validateKeys(["startAngle","endAngle","radiusX","radiusY","rotation"])&&t.ellipse(e.x,e.y,this.data.radiusX,this.data.radiusY,this.data.rotation,this.data.startAngle,this.data.endAngle),Object.assign({},e)}}class st{constructor(t){this._instance={},t&&this.set(t)}set(t){return this._instance=n(this._instance,t),this}setFillStyle(t){return this._instance.fillStyle=t,this}setStrokeStyle(t){return this._instance.strokeStyle=t,this}setShadowColor(t){return this._instance.shadowColor=t,this}setShadow(t,e,s,i){return this.set({shadowColor:t,shadowOffsetX:e,shadowOffsetY:s,shadowBlur:i})}setFont(t){return this._instance.font=t,this}setText(t,e,s){return this.set({font:t,textAlign:e,textBaseline:s})}setStrokeWidth(t){return this._instance.strokeWidth=t,this}setStroke(t,e,s,i,n,r){return this.set({strokeWidth:t,lineDashOffset:n,lineJoin:e,lineCap:s,lineDash:i})}setStrokeDash(t,e){return this._instance.lineDash=t,e&&(this._instance.lineDashOffset=e),this}setStrokeDetails(t,e,s){return this.set({lineJoin:t,lineCap:e,mitterLimit:s})}get(){return this._instance}}class it{constructor(t){this._setup={unit:"px"},t&&this.set(t)}set(t){return this._setup=n(this._setup,t),this}setType(t){return this._setup.type=t,this}setSize(t){return this._setup.size=t,this}setUnit(t){return this._setup.unit=t,this}setStyle(t){return this._setup.style=t,this}asString(){var t;let e=[];return this._setup.style&&e.push(this._setup.style),this._setup.size&&e.push(this._setup.size+(null!==(t=this._setup.unit)&&void 0!==t?t:"")),this._setup.type&&e.push(this._setup.type),e.join(" ")}}}])}));
//# sourceMappingURL=bpdCanvas.min.js.map